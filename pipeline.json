[ { "grok": { "field": "message", "patterns": [ "\"result-timestamp\":\"%{TIMESTAMP_ISO8601:timestamp}\"" ] } }, { "date": { "field": "timestamp", "formats": [ "ISO8601" ] } }, { "json": { "field": "message", "target_field": "parsed_message" } }, { "set": { "field": "log.level", "copy_from": "parsed_message.summary.level" } }, { "script": { "source": "if (ctx.log?.level == 'warning') { ctx.warning = true; } if (ctx.log?.level == 'note') { ctx.note = true; } if (ctx.log?.level == 'error') { ctx.error = true; } if (ctx.log?.level == 'info') { ctx.info = true; }" } } ]
